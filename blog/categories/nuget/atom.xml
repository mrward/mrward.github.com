<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: nuget | Matt Ward]]></title>
  <link href="http://lastexitcode.com/blog/categories/nuget/atom.xml" rel="self"/>
  <link href="http://lastexitcode.com/"/>
  <updated>2020-01-19T13:26:41+00:00</updated>
  <id>http://lastexitcode.com/</id>
  <author>
    <name><![CDATA[Matt Ward]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[NuGet Support in Visual Studio for Mac 8.4]]></title>
    <link href="http://lastexitcode.com/blog/2020/01/19/NuGetSupportInVisualStudioMac8-4/"/>
    <updated>2020-01-19T12:00:00+00:00</updated>
    <id>http://lastexitcode.com/blog/2020/01/19/NuGetSupportInVisualStudioMac8-4</id>
    <content type="html"><![CDATA[<h2>Changes</h2>

<ul>
<li> Improved accessibility of the Manage NuGet Packages dialog and Add Package Source dialog</li>
<li> Fixed updating multiple NuGet packages failing due to restricted version range of a common dependency</li>
</ul>


<p>More information on all the new features and changes in <a href="https://www.visualstudio.com/vs/visual-studio-mac/">Visual Studio for Mac 8.4</a>
can be found in the <a href="https://docs.microsoft.com/en-us/visualstudio/releasenotes/vs2019-mac-relnotes">release notes</a>.</p>

<h2>Accessibility Improvements &ndash; Manage NuGet Packages dialog</h2>

<p><strong>Voice Over now recognises tabs</strong></p>

<p>The Browse, Installed, Updates and Consolidates tabs are now recognised as tabs
by Voice Over. Previously they were being treated as text labels and Voice Over
would not announce that a tab could be selected via Control-Option-Space.</p>

<p><strong>Voice Over now announces status messages</strong></p>

<p>The status message that is displayed with the busy spinner image is now
announced by Voice Over. When the status message is removed another
message is announced by Voice Over to say the loading has completed
or, if a search filter was entered, search was completed. If no
packages are found when searching this message is also announced
by Voice Over.</p>

<p><strong>Improve Voice Over reading of Id label</strong></p>

<p>The Id label has been changed to ID. Using ID allows Voice Over to announce it as I.D. instead of a single
word. Note that some Voice Over voices, such as English UK, still
announce the text incorrectly. Without changing the label text to be &ldquo;I.D.&rdquo;
there does not seem to be a way of fixing this for all voices. System
Preferences on the Mac can be used to change the pronounciation for
certain words if required.</p>

<p><strong>Voice Over now reads first column header in Consolidate tab</strong></p>

<p>The check box to select a project to consolidate was in its own column that
had no name. Using Voice Over it was not obvious what this check box was for. Now the check
box and the project name are in the same column and Voice Over reads
the column header name, the project name and the checkbox state which
makes it easier to understand what the list is displaying.</p>

<p><strong>Voice Over now reading associated labels for selected UI control</strong></p>

<p>Labels were not associated with their corresponding UI controls which
resulted in them not being read by Voice Over when corresponding UI control
was selected.</p>

<p>The package source combo box is now read by Voice Over as &lsquo;Package Sources&rsquo;.
Previously there was no associated label information being read.</p>

<p>Voice Over now reads the label for Search text field. The search text box now shows &lsquo;Search&rsquo; as
placeholder text.</p>

<p><strong>Voice Over now reading package list information</strong></p>

<p>Voice Over now reads the package information in the list and the check box
can be ticked or unticked by using Voice Over. Previously no information was
read by Voice Over and the check box could not be accessed.</p>

<p><strong>Keyboard can now be used to move across tabs</strong></p>

<p>Previously it was not possible to tab across the Browse, Installed, Updates or Consolidate tabs.</p>

<p>This change will be in Visual Studio for Mac 8.4.2.</p>

<h2>Accessibility Improvements &ndash; Add Package Source Dialog</h2>

<p>In Preferences &ndash; NuGet &ndash; Sources, the Add Package Source dialog
would lose focus when the Browse button was used. A way to reproduce
this is to tab to the Add button, press space, then tab to the
Browse button in the Add Package Source dialog, press space, then
press escape. The Add Package Source dialog then no longer has focus
and tabbing does not work.</p>

<p>This has been fixed by explicitly setting focus back to the parent dialog
when a child dialog is closed.</p>

<h2>Bug Fixes</h2>

<p><strong>Fixed updating multiple NuGet packages failing due to restricted version range of a common dependency</strong></p>

<p>Updating two NuGet package references that have a strict dependency
on a single version of another NuGet package, not explicitly added
to the project, would fail in the Manage NuGet Packages dialog. This
was because the update was being done one NuGet package at a time.</p>

<p>With an Android project that uses Xamarin.Forms this could happen when updating
Xamarin.Essentials, an Xamarin.Android.Support.Core.Utils and Xamarin.Forms at the same time.
The Xamarin.Android.Support NuGet packages
depend on specific versions for their dependencies which can cause the update to fail
depending on whether a NuGet package is updated on its own or in a group. The resulting failure
would be similar to</p>

<p><code>
Version conflict detected for Xamarin.Android.Support.Collections. Install/reference Xamarin.Android.Support.Collections 28.0.0.3 directly to project to resolve this issue.
 MyProject.Android -&gt; Xamarin.Android.Support.Core.Utils 28.0.0.3 -&gt; Xamarin.Android.Support.Compat 28.0.0.3 -&gt; Xamarin.Android.Support.Collections (= 28.0.0.3)
 MyProject.Android -&gt; Xamarin.Essentials 1.2.0 -&gt; Xamarin.Android.Support.CustomTabs 28.0.0.1 -&gt; Xamarin.Android.Support.Collections (= 28.0.0.1).
</code></p>

<p>Updating NuGet packages in the Manage NuGet packages dialog is now done
as a batch instead of individually. This allows NuGet to
update both NuGet packages so they then use the new strict dependency.</p>

<p>Note that updating all packages in the project from the Solution
window does not have this problem since there the packages were already
updated together in a batch.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[NuGet Support in Visual Studio for Mac 8.3]]></title>
    <link href="http://lastexitcode.com/blog/2019/10/06/NuGetSupportInVisualStudioMac8-3/"/>
    <updated>2019-10-06T12:00:00+01:00</updated>
    <id>http://lastexitcode.com/blog/2019/10/06/NuGetSupportInVisualStudioMac8-3</id>
    <content type="html"><![CDATA[<h2>Changes</h2>

<ul>
<li> NuGet 5.3 support</li>
<li> Managing NuGet packages for the solution</li>
<li> Show NuGet package updates for SDK style projects in the Solution window</li>
</ul>


<p>More information on all the new features and changes in <a href="https://www.visualstudio.com/vs/visual-studio-mac/">Visual Studio for Mac 8.3</a>
can be found in the <a href="https://docs.microsoft.com/en-us/visualstudio/releasenotes/vs2019-mac-relnotes">release notes</a>.</p>

<h2>NuGet 5.3 support</h2>

<p><a href="https://docs.microsoft.com/en-us/nuget/release-notes/nuget-5.3">NuGet 5.3.0.6192</a> is now
included with Visual Studio for Mac 8.3.</p>

<h2>Managing NuGet Packages for the solution</h2>

<p>Support for managing NuGet packages for the solution was originally available in a separate
<a href="https://github.com/mrward/monodevelop-nuget-extensions">NuGet extensions addin</a>. This feature has now
been integrated into Visual Studio for Mac, along with some user interface changes, and is now available by
default.</p>

<p><img src="/images/blog/NuGetSupportInVisualStudioMac8-3/ManageNuGetPackagesSolutionBrowseTab.png" title="&lsquo;Manage NuGet Packages &ndash; Solution &ndash; Browse tab&rsquo; &lsquo;Manage NuGet Packages &ndash; Solution &ndash; Browse tab&rsquo;" ></p>

<p>The NuGet extensions addin is still available and provides a
NuGet Powershell Console but it no longer includes a Manage NuGet Packages dialog.</p>

<p>The Manage NuGet Packages dialog contains four tabs:</p>

<ul>
<li>Browse

<ul>
<li>Used to search for and install NuGet packages. This is equivalent to the old Add NuGet Packages dialog.</li>
</ul>
</li>
<li>Installed

<ul>
<li>Shows the installed NuGet packages. NuGet packages can be uninstalled from this tab.</li>
</ul>
</li>
<li>Updates

<ul>
<li>Shows NuGet packages that have new versions available.</li>
</ul>
</li>
<li>Consolidate

<ul>
<li>Shows NuGet packages that have multiple versions installed in the solution. This is only available when managing
NuGet packages for the solution.</li>
</ul>
</li>
</ul>


<p>The Add Packages dialog has been removed and replaced with the Manage NuGet Packages dialog since everything that was supported with the Add Packages dialog is available the new dialog.</p>

<p>To manage the NuGet packages for
the solution the Manage NuGet Packages dialog can be opened in the following ways:</p>

<ul>
<li>Right click the solution in the Solution window and select <strong>Manage NuGet Packages&hellip;</strong></li>
<li>From the main menu select <strong>Project</strong> &ndash; <strong>Manage NuGet Packages&hellip;</strong></li>
</ul>


<p>The Manage NuGet Packages dialog title is different depending on whether the NuGet packages
are being managed for the solution or for the project. When managing packages for the solution
the dialog title will be <strong>Manage NuGet Packages â€“ Solution</strong>.</p>

<h3>Managing NuGet Packages for a single project</h3>

<p>To manage NuGet packages for a single project the Manage NuGet Packages dialog can be opened
in the following ways:</p>

<ul>
<li>Right click the project in the Solution window and select <strong>Manage NuGet Packages&hellip;</strong>

<ul>
<li>This was added to make Visual Studio for Mac consistent with Visual Studio on Windows</li>
</ul>
</li>
<li>Double click the Packages folder in the Solution window</li>
<li>Right click the Packages folder and select <strong>Manage NuGet Packages&hellip;</strong></li>
<li>Double click the Dependencies folder in the Solution window.

<ul>
<li>In previous versions of Visual Studio for Mac this would not open the dialog</li>
</ul>
</li>
<li>Right click the Depdendencies folder and select <strong>Manage NuGet Packages..</strong></li>
<li>Double click the NuGet folder underneath the Dependencies folder</li>
<li>Right click the NuGet folder, underneath the Dependencies folder, and select <strong>Manage NuGet Packages&hellip;</strong></li>
</ul>


<p>When managing NuGet packages for a single project the dialog title shows the project name
<strong>Manage NuGet Packages â€“ ProjectName</strong>.</p>

<p><img src="/images/blog/NuGetSupportInVisualStudioMac8-3/ManageNuGetPackagesProject.png" title="&lsquo;Manage NuGet Packages for Project&rsquo; &lsquo;Manage NuGet Packages for Project&rsquo;" ></p>

<h3>Installing NuGet Packages</h3>

<p>The Browse tab in the Manage NuGet Packages can be used to search for and install NuGet packages
into one or more projects. This tab is equivalent to the old Add NuGet Packages dialog.</p>

<p>The latest stable NuGet package version is now indicated by
having <strong>(latest stable)</strong> appended on the right hand
side of the dialog.</p>

<p>To install a NuGet package into multiple projects:</p>

<ul>
<li>Right click the solution and select <strong>Manage NuGet Packages&hellip;</strong></li>
<li>Search for a NuGet package</li>
<li>Click the <strong>Add Package</strong> button</li>
<li>In the Select Projects dialog that is opened, select the projects that you want the NuGet package to be installed, and click OK</li>
</ul>


<p><img src="/images/blog/NuGetSupportInVisualStudioMac8-3/ManageNuGetPackagesSolutionSelectProjects.png" title="&lsquo;Manage NuGet Packages &ndash; Select Projects dialog&rsquo; &lsquo;Manage NuGet Packages &ndash; Select Projects dialog&rsquo;" ></p>

<h3>Uninstalling NuGet Packages</h3>

<p>The Installed tab in the Manage NuGet Packages can be used to uninstall
NuGet packages from one or more projects.</p>

<p><img src="/images/blog/NuGetSupportInVisualStudioMac8-3/ManageNuGetPackagesInstalledTab.png" title="&lsquo;Manage NuGet Packages &ndash; Installed tab&rsquo; &lsquo;Manage NuGet Packages &ndash; Installed tab&rsquo;" ></p>

<p>To uninstall a NuGet package:</p>

<ul>
<li>Right click the solution and select <strong>Manage NuGet Packages&hellip;</strong></li>
<li>Select the Installed tab</li>
<li>Select a NuGet package to uninstall

<ul>
<li>To uninstall multiple NuGet packages use the check boxes in the package list</li>
</ul>
</li>
<li>Click the <strong>Uninstall Package</strong> button</li>
<li>In the Select Projects dialog that is opened, select the projects where the NuGet package should be removed, and click OK.</li>
</ul>


<h3>Updating NuGet Packages</h3>

<p>The Updates tab shows the updated NuGet packages available to be installed.</p>

<p><img src="/images/blog/NuGetSupportInVisualStudioMac8-3/ManageNuGetPackagesUpdatesTab.png" title="&lsquo;Manage NuGet Packages &ndash; Updates tab&rsquo; &lsquo;Manage NuGet Packages &ndash; Updates tab&rsquo;" ></p>

<p>The Updates tab shows the <strong>Current Version</strong> of the NuGet package installed on the right hand side of the dialog. If
multiple versions of the packages are installed across the solution, then this will
display <strong>Multiple</strong> with an information icon where information about the
projects and versions can be viewed in a tooltip.</p>

<p><img src="/images/blog/NuGetSupportInVisualStudioMac8-3/UpdatesTabMultipleVersions.png" title="&lsquo;Manage NuGet Packages &ndash; Updates tab &ndash; Multiple versions installed&rsquo; &lsquo;Manage NuGet Packages &ndash; Updates tab &ndash;  Multiple versions installed&rsquo;" ></p>

<p><img src="/images/blog/NuGetSupportInVisualStudioMac8-3/UpdatesTabMultipleVersionsTooltip.png" title="&lsquo;Manage NuGet Packages &ndash; Updates tab &ndash; Multiple versions installed &ndash; tooltip&rsquo; &lsquo;Manage NuGet Packages &ndash; Updates tab &ndash;  Multiple versions installed &ndash; tooltip&rsquo;" ></p>

<p>To update a NuGet package in multiple projects:</p>

<ul>
<li>Right click the solution and select <strong>Manage NuGet Packages&hellip;</strong></li>
<li>Select the Updates tab</li>
<li>Select a NuGet package to update

<ul>
<li>To update multiple NuGet packages use the check boxes in the packages list</li>
</ul>
</li>
<li>Click the <strong>Update Package</strong> button</li>
<li>In the Select Projects dialog that is opened, select the projects where the NuGet package should be updated, and click OK.</li>
</ul>


<h3>Consolidating NuGet Packages</h3>

<p>If there are different versions of a NuGet package installed in the solution the
Consolidate tab will show this and allow the packages to be consolidated to a particular version.</p>

<p><img src="/images/blog/NuGetSupportInVisualStudioMac8-3/ManageNuGetPackagesConsolidateTab.png" title="&lsquo;Manage NuGet Packages &ndash; Consolidate tab&rsquo; &lsquo;Manage NuGet Packages &ndash; Consolidate tab&rsquo;" ></p>

<p>When a NuGet package is selected, the right hand side of the dialog shows
all the projects in the solution. The project will be checked if it has the selected
package installed. The package version used by the project is also shown.
Projects that have a package to consolidate are shown first in the list.</p>

<p>Note that the Consolidate tab is only displayed if NuGet packages are being
managed for the solution.</p>

<p>By default the Consolidate tab will select the latest version available from the current NuGet package source.
This may be different from the latest version installed in the projects.</p>

<p>To Consolidate a NuGet package:</p>

<ul>
<li>Right click the solution and select <strong>Manage NuGet Packages&hellip;</strong></li>
<li>Select the Consolidate tab</li>
<li>Select the NuGet package you want to consolidate.

<ul>
<li>Use the check box next to the NuGet package if you want to consolidate multiple NuGet packages at the same time</li>
</ul>
</li>
<li>Check or uncheck the projects in the projects list.

<ul>
<li>By default projects that contain the selected NuGet package will be checked</li>
</ul>
</li>
<li>Click the <strong>Consolidate Package</strong> button.</li>
</ul>


<h2>Show NuGet package updates for SDK style projects in the Solution window</h2>

<p>NuGet package updates are now shown in the Solution window for SDK style
projects.</p>

<p><img src="/images/blog/NuGetSupportInVisualStudioMac8-3/SdkStyleProjectPackageUpdates.png" title="&lsquo;SDK style project &ndash; package updates &ndash; solution window&rsquo; &lsquo;SDK style project &ndash; package updates &ndash; solution window&rsquo;" ></p>

<p>If an updated package is available this information will now be shown
on the Dependencies folder, the NuGet folder, and the top level
package in the Solution window.</p>

<p>Previously NuGet package updates were only displayed for projects
that used a packages.config file or for non-SDK style projects
that used PackageReferences.</p>

<p>Instead of showing the updated NuGet package version text, next to the installed version
in the solution window, an update icon
is displayed with the version information available in a tooltip. This prevents
the version information taking up a lot of space to the right, which can
happen for long version numbers.</p>

<p><img src="/images/blog/NuGetSupportInVisualStudioMac8-3/SdkStyleProjectPackageUpdateVersionTooltip.png" title="&lsquo;SDK style project &ndash; package update version tooltip &ndash; solution window&rsquo; &lsquo;SDK style project &ndash; package update version tooltip &ndash; solution window&rsquo;" ></p>

<p>The Update menu, when right clicking a NuGet package, now shows the
version for the update. Otherwise
the Update menu is displayed.</p>

<p><img src="/images/blog/NuGetSupportInVisualStudioMac8-3/SdkStyleProjectUpdateToMenuItem.png" title="&lsquo;SDK style project &ndash; update menu item &ndash; solution window&rsquo; &lsquo;SDK style project &ndash; update menu item &ndash; solution window&rsquo;" ></p>

<p>If there is an update and a NuGet warning only the warning icon
will be displayed with the warning message available in the tooltip.
The update information will only be available in the right click
context menu for the NuGet package in this case.</p>

<p>Package versions are now displayed in solution window for non-SDK style projects.</p>

<p><img src="/images/blog/NuGetSupportInVisualStudioMac8-3/NonSdkStyleProjectPackageUpdates.png" title="&lsquo;Non-SDK style project &ndash; package updates &ndash; solution window&rsquo; &lsquo;Non-SDK style project &ndash; package updates &ndash; solution window&rsquo;" ></p>

<p>SDK style projects always displayed the package version in the Solution
window but non-SDK style projects did not. To make these consistent the NuGet
package version is now shown in the Solution window for all project types.</p>

<p>Previously for non-SDK style projects the package version was shown
as a menu item when right clicking a NuGet package. This has been removed
since the package version is now displayed next to the package id in the
Solution window.</p>

<h2>Bug Fixes</h2>

<p><strong>Fixed text colour when row selected in Manage NuGet Packages dialog</strong></p>

<p>When a package was checked in the Add NuGet Packages dialog any
row that was selected would display black text instead of white text. This was hard
to read with the blue background colour used for the selected row. The wrong text colour was being set when a package was
checked. This has been fixed in the Manage NuGet Packages dialog.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[NuGet Support in Visual Studio for Mac 8.2]]></title>
    <link href="http://lastexitcode.com/blog/2019/07/28/NuGetSupportInVisualStudioMac8-2/"/>
    <updated>2019-07-28T12:00:00+01:00</updated>
    <id>http://lastexitcode.com/blog/2019/07/28/NuGetSupportInVisualStudioMac8-2</id>
    <content type="html"><![CDATA[<h2>Changes</h2>

<ul>
<li> NuGet 5.1 support</li>
<li> Support partial installs into multi-target framework projects</li>
<li> Fixed no network error displayed in Add Packages dialog</li>
<li> Fixed restoring too many projects when target framework changed</li>
<li> Fixed adding non-sdk style project triggering NuGet restore multiple times</li>
<li> Fixed restore menu incorrectly disabled</li>
</ul>


<p>More information on all the new features and changes in <a href="https://www.visualstudio.com/vs/visual-studio-mac/">Visual Studio for Mac 8.2</a>
can be found in the <a href="https://docs.microsoft.com/en-us/visualstudio/releasenotes/vs2019-mac-relnotes">release notes</a>.</p>

<h2>NuGet 5.1 support</h2>

<p><a href="https://docs.microsoft.com/en-us/nuget/release-notes/nuget-5.1-rtm">NuGet 5.1.0.6013</a> is now
included with Visual Studio for Mac 8.2.</p>

<h2>Support partial installs into multi-target framework projects</h2>

<p>A NuGet package being installed into a multi-target framework project
may not support all frameworks. When this happens the PackageReference
will now be added with a condition so the NuGet package is not used
for frameworks that are not supported.</p>

<p>```
<Project Sdk="Microsoft.NET.Sdk"></p>

<p>  <PropertyGroup></p>

<pre><code>&lt;TargetFrameworks&gt;net472;netstandard1.2&lt;/TargetFrameworks&gt;
</code></pre>

<p>  </PropertyGroup></p>

<p>  <ItemGroup Condition="'$(TargetFramework)' == 'net472'"></p>

<pre><code>&lt;PackageReference Include="EntityFramework" Version="6.2.0" /&gt;
</code></pre>

<p>  </ItemGroup>
</Project>
```</p>

<h2>Bug Fixes</h2>

<p><strong>Fixed no network error displayed in Add Packages dialog</strong></p>

<p>Networking errors were not being reported in the Add Packages dialog
resulting in no information being available explaining why there were
no search results.</p>

<p>Visual Studio for Mac uses Xamarin.Mac&rsquo;s NSUrlSessionHandler
for HTTP requests and the NSUrlSessionHandler reports errors
using curly braces. For example:</p>

<p><code>
[nuget.org] The Internet connection appears to be offline.
  Error Domain=NSURLErrorDomain Code=-1009 "The Internet connection appears to be offline." UserInfo={NSUnderlyingError=0x7fce42892a80 {Error Domain=kCFErrorDomainCFNetwork Code=-1009 "(null)" UserInfo={_kCFStreamErrorCodeKey=50, _kCFStreamErrorDomainKey=1}}, NSErrorFailingURLStringKey=https://api-v2v3search-1.nuget.org/query?q=&amp;skip=0&amp;take=26&amp;prerelease=false&amp;supportedFramework=Xamarin.iOS,Version=v1.0&amp;semVerLevel=2.0.0, NSErrorFailingURLKey=https://api-v2v3search-1.nuget.org/query?q=&amp;skip=0&amp;take=26&amp;prerelease=false&amp;supportedFramework=Xamarin.iOS,Version=v1.0&amp;semVerLevel=2.0.0, _kCFStreamErrorDomainKey=1, _kCFStreamErrorCodeKey=50, NSLocalizedDescription=The Internet connection appears to be offline.}
</code></p>

<p>This text was then being passed to string.Format in the Add Packages
dialog and was causing a FormatException. The error would then not be
displayed in the Add Packages dialog. The text now has the curly braces
escaped to prevent the FormatException.</p>

<p><strong>Fixed restoring too many projects when target framework changed</strong></p>

<p>When the target framework was changed in a SDK style project all SDK style
projects in the solution were restored. Now only the project and
projects that depend on it are restored.</p>

<p><strong>Fixed adding non-sdk style project triggering NuGet restore multiple times</strong></p>

<p>Adding a new non-sdk style project to a solution could cause a NuGet
restore to run multiple times.</p>

<p>The problem was that the SDK style projects, such as those that target
Xamarin.Mac, may change their target framework on re-evaluation. This
was causing Visual Studio for Mac
to run a restore for all SDK style projects in the solution, multiple
times. To avoid this the target framework changes during re-evaluation
are ignored.</p>

<p><strong>Fixed restore menu incorrectly disabled</strong></p>

<p>In the Solution window on right clicking a solution, or the packages folder, the restore
menu was incorrectly disabled when an SDK style project targeted .NET Framework
or when the project had its RestoreProjectStyle set to PackageReference and
had no PackageReferences.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[NuGet Support in Visual Studio for Mac 8.1]]></title>
    <link href="http://lastexitcode.com/blog/2019/06/22/NuGetSupportInVisualStudioMac8-1/"/>
    <updated>2019-06-22T12:40:00+01:00</updated>
    <id>http://lastexitcode.com/blog/2019/06/22/NuGetSupportInVisualStudioMac8-1</id>
    <content type="html"><![CDATA[<h2>Changes</h2>

<ul>
<li> NuGet 5.0 support</li>
<li> Fixed PackageReference metadata not added for development dependencies</li>
<li> Fixed DotNetCliToolReferences not being restored</li>
<li> Fixed Multiplatform Library build error with Android projects</li>
</ul>


<p>More information on all the new features and changes in <a href="https://www.visualstudio.com/vs/visual-studio-mac/">Visual Studio for Mac 8.1</a>
can be found in the <a href="https://docs.microsoft.com/en-us/visualstudio/releasenotes/vs2019-mac-relnotes">release notes</a>.</p>

<h2>NuGet 5.0 support</h2>

<p><a href="https://docs.microsoft.com/en-us/nuget/release-notes/nuget-5.0-rtm">NuGet 5.0.2.5988</a> is now
included with Visual Studio for Mac 8.1.</p>

<h2>Bug Fixes</h2>

<p><strong>Fixed PackageReference metadata not added for development dependencies</strong></p>

<p>Installing a NuGet package that is a development dependency, such as
GitInfo, would not add the PrivateAssets nor the IncludeAssets
metadata to the PackageReference. This is now supported and mirrors the
behaviour of &lsquo;dotnet add package&rsquo; and Visual Studio on Windows.</p>

<p><strong>Fixed DotNetCliToolReferences not being restored</strong></p>

<p>DotNetCliToolReferences are available in the package dependency graph
but are treated as separate projects in this graph. Since these did not map
to an existing project in the solution they were not added to the full dependency
graph which resulted in these tools not being restored.</p>

<p>DotNetCliToolReferences are only restored when the entire solution is restored.
Restoring a single project only restores the project itself not
the dotnet cli tool project referenced by the project.</p>

<p>MSBuild supports restoring DotNetCliToolReferences in any project type that
uses PackageReferences so Visual Studio for Mac also supports this.</p>

<p><strong>Fixed Multiplatform Library build error with Android projects</strong></p>

<p>When generating a Portable Class Library (PCL) assembly from the intersection of project
assemblies the ApiIntersect build task would throw an exception since
it could not resolve the Mono.Android assembly. This problem has been
fixed in a more recent NuGet.Build.Packaging where the failure to
resolve has been converted to a warning.</p>

<p>```
System.Exception: Could not resolve Mono.Android, Version=0.0.0.0, Culture=neutral, PublicKeyToken=84e04ff9cfb79065</p>

<pre><code>at ApiIntersect.FrameworkAssemblyResolver.Resolve (Mono.Cecil.AssemblyNameReference name, Mono.Cecil.ReaderParameters parameters) [0x0001b] in &lt;aac3e0d5bcd4473a96e385115da49b96&gt;:0
at ApiIntersect.FrameworkAssemblyResolver.Resolve (Mono.Cecil.AssemblyNameReference name) [0x00000] in &lt;aac3e0d5bcd4473a96e385115da49b96&gt;:0
at ICSharpCode.Decompiler.Ast.Transforms.IntroduceUsingDeclarations.Run (ICSharpCode.NRefactory.CSharp.AstNode compilationUnit) [0x00142] in &lt;37b5ad8a7a94479fbc5b574a8fc6281a&gt;:0
at ICSharpCode.Decompiler.Ast.Transforms.TransformationPipeline.RunTransformationsUntil (ICSharpCode.NRefactory.CSharp.AstNode node, System.Predicate`1[T] abortCondition, ICSharpCode.Decompiler.DecompilerContext context) [0x0002c] in &lt;37b5ad8a7a94479fbc5b574a8fc6281a&gt;:0
at ICSharpCode.Decompiler.Ast.AstBuilder.RunTransformations (System.Predicate`1[T] transformAbortCondition) [0x00000] in &lt;37b5ad8a7a94479fbc5b574a8fc6281a&gt;:0
at ICSharpCode.Decompiler.Ast.AstBuilder.RunTransformations () [0x00000] in &lt;37b5ad8a7a94479fbc5b574a8fc6281a&gt;:0
at ApiIntersect.MainClass.DumpTypes (System.Collections.Generic.List`1[T] types, System.String baseDir) [0x000a7] in &lt;aac3e0d5bcd4473a96e385115da49b96&gt;:0
at ApiIntersect.MainClass.Process (System.Collections.Generic.List`1[T] intersections, System.Collections.Generic.List`1[T] exclusions, Mono.Cecil.ReaderParameters readerParameters, System.String outputPath) [0x00319] in &lt;aac3e0d5bcd4473a96e385115da49b96&gt;:0
at ApiIntersect.MainClass.Main (System.String[] args) [0x0039f] in &lt;aac3e0d5bcd4473a96e385115da49b96&gt;:0
</code></pre>

<p>```</p>

<p>An updated NuGet.Build.Packaging has not been published to nuget.org
so only new projects created with Visual Studio for Mac will get the
NuGet package containing the fix.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[NuGet PowerShell Core Console in Visual Studio for Mac 8.0]]></title>
    <link href="http://lastexitcode.com/blog/2019/05/05/NuGetPowerShellCoreConsoleVisualStudioForMac8-0/"/>
    <updated>2019-05-05T12:40:00+01:00</updated>
    <id>http://lastexitcode.com/blog/2019/05/05/NuGetPowerShellCoreConsoleVisualStudioForMac8-0</id>
    <content type="html"><![CDATA[<p>The <a href="https://github.com/mrward/monodevelop-nuget-extensions">NuGet extensions addin</a> now includes a PowerShell
Core based NuGet Package Manager console for Visual Studio for Mac 8.0.</p>

<p><img src="/images/blog/NuGetPowerShellCoreConsoleVisualStudioMac8-0/NuGetPackageManagerConsoleWindow.png" title="&lsquo;NuGet Package Manager Console&rsquo; &lsquo;NuGet Package Manager Console window&rsquo;" ></p>

<p>A <a href="https://lastexitcode.com/blog/2014/06/22/NuGetPowerShellConsoleForXamarinStudio/">NuGet PowerShell console</a> has been available with
the <a href="https://github.com/mrward/monodevelop-nuget-extensions">NuGet extensions addin</a> since
Xamarin Studio 5.0. Previously it used <a href="https://github.com/Pash-Project/Pash">Pash</a>, a cross-platform, open source reimplementation
of PowerShell. Pash is no longer being actively developer on after Microsoft released <a href="https://github.com/PowerShell/PowerShell">PowerShell Core</a>.
The PowerShell support in Pash was incomplete, so whilst the NuGet commands, such as Install-Package, were supported, more
complicated commands, such as those provided by <a href="https://docs.microsoft.com/en-us/ef/core/">Entity Framework Core</a>, were not supported.
Moving to PowerShell Core provides full PowerShell support, and with a partial implementation of the Visual Studio EnvDTE API,
<a href="https://docs.microsoft.com/en-us/ef/core/miscellaneous/cli/powershell">Entity Framework Core commands</a> are now supported.</p>

<p>The NuGet extensions addin runs a .NET Core console
application that hosts PowerShell Core. Communication between
the addin running in Visual Studio for Mac and the console application is through the
<a href="https://github.com/Microsoft/vs-streamjsonrpc">StreamJsonRpc</a> library.</p>

<h2>New Features</h2>

<p>The following lists the new features compared with the Pash based PowerShell console.</p>

<ul>
<li>PowerShell Core based NuGet Package Manager Console

<ul>
<li>Full PowerShell support</li>
<li>Get-Help now supported</li>
</ul>
</li>
<li>Support for Entity Framework Core NuGet commands</li>
<li>Tab completion</li>
<li>Support for stopping the executing command</li>
<li>Opening the NuGet package source configuration page from the console</li>
</ul>


<h2>Limitations</h2>

<ul>
<li><strong>Visual Studio EnvDTE API implementation is incomplete</strong></li>
</ul>


<p> The Visual Studio EnvDTE API is partially implemented. Whilst Entity Framework Core is
 supported other PowerShell scripts included with NuGet packages may not work.</p>

<ul>
<li><p><strong>Password protected NuGet package sources not supported in the following PowerShell commands:</strong></p>

<ul>
<li>Find-Package</li>
<li>Get-Package</li>
</ul>
</li>
</ul>


<p>Note that the other NuGet PowerShell commands are supported.</p>

<p>The NuGet extensions addin will not send usernames and passwords to the PowerShell Core
host console application. .NET Core also does not support decrypting passwords stored in the
NuGet.Config file.</p>

<p>The Find-Package and Get-Package commands all run completely within PowerShell hosted in the .NET Core
console application.</p>

<p>The other commands work since they run partially within Visual for Mac where actions involving password protected
NuGet package sources are supported.</p>

<ul>
<li><strong>Requires .NET Core 2.1 SDK to be installed</strong></li>
</ul>


<h2>Opening the NuGet Package Manager Console window</h2>

<p>From the View menu, select Pads, then select NuGet Package Manager Console.</p>

<p><img src="/images/blog/NuGetPowerShellCoreConsoleVisualStudioMac8-0/ViewPadsNuGetPackageManagerConsoleMenu.png" title="&lsquo;View &ndash; Pages &ndash; NuGet Package Manager Console menu&rsquo; &lsquo;View &ndash; Pages &ndash; NuGet Package Manager Console menu&rsquo;" ></p>

<h2>Â Entity Framework Core Support</h2>

<p>The PowerShell commands provided by the
<a href="https://docs.microsoft.com/en-us/ef/core/miscellaneous/cli/powershell">Microsoft.EntityFrameworkCore.Tools NuGet package</a>
are supported in .NET Core projects.</p>

<ul>
<li>Add-Migration</li>
<li>Drop-Database</li>
<li>Get-DbContext</li>
<li>Remove-Migration</li>
<li>Scaffold-DbContext</li>
<li>Script-Migration</li>
<li>Update-Database</li>
</ul>


<p><img src="/images/blog/NuGetPowerShellCoreConsoleVisualStudioMac8-0/EntityFrameworkCoreMigrationPowerShellCommands.png" title="&lsquo;Package Manager Console &ndash; Entity Framework Core Add-Migration and Update-Database commands&rsquo; &lsquo;Package Manager Console &ndash; Entity Framework Core Add-Migration and Update-Database commands&rsquo;" ></p>

<p>Note that the Entity Framework Core commands are not currently supported in projects that target the .NET Framework. This
is because the PowerShell commands attempt to directly run ef.exe that is included in the NuGet package instead of using the .NET Core ef.dll
which is used with projects that target .NET Core.</p>

<h2>Tab Completion</h2>

<p>Pressing tab in the console window will try to auto-complete the command being typed in.</p>

<p><img src="/images/blog/NuGetPowerShellCoreConsoleVisualStudioMac8-0/TabCompletionNewtonsoftJson.png" title="&lsquo;Tab completion &ndash; Install-Package Newtonsoft.Json&rsquo; &lsquo;Tab completion &ndash; Install-Package Newtonsoft.Json&rsquo;" ></p>

<p><img src="/images/blog/NuGetPowerShellCoreConsoleVisualStudioMac8-0/TabCompletionPackageVersion.png" title="&lsquo;Tab completion &ndash; Install-Package Newtonsoft.Json -Version&rsquo; &lsquo;Tab completion &ndash; Install-Package Newtonsoft.Json -Version&rsquo;" ></p>

<p>If there is only one match on pressing tab then the text will be inserted.</p>

<p>If there are multiple possible matches then a window will be displayed allowing an
item to be selected by pressing Tab, Enter or Return. Typing with this completion list
window open will filter the items in the list.</p>

<h2>Stopping the PowerShell command being run</h2>

<p>When a PowerShell command is being run the Stop button is enabled. The Stop button is the last button on the top right of the NuGet
Package Console window.</p>

<p><img src="/images/blog/NuGetPowerShellCoreConsoleVisualStudioMac8-0/PackageManagerConsoleStopButton.png" title="&lsquo;Package Manager Console stop button&rsquo; &lsquo;Package Manager Console stop button&rsquo;" ></p>

<p>Clicking this button will attempt to stop the PowerShell command being run.</p>

<p><img src="/images/blog/NuGetPowerShellCoreConsoleVisualStudioMac8-0/PackageManagerConsolePipelineStopped.png" title="&lsquo;Package Manager Console pipeline stopped&rsquo; &lsquo;Package Manager Console pipeline stopped&rsquo;" ></p>

<h2>Opening the NuGet Package Console configuration page</h2>

<p>At the top of the NuGet Package Console window there is a cog icon after the list of package sources.</p>

<p><img src="/images/blog/NuGetPowerShellCoreConsoleVisualStudioMac8-0/PackageManagerConsoleCogIcon.png" title="&lsquo;Package Manager Console configure sources &ndash; cog icon&rsquo; &lsquo;Package Manager Console configure sources cog icon&rsquo;" ></p>

<p>Clicking this cog icon will open the NuGet Package Sources configuration
page which is also available from Preferences &ndash; NuGet &ndash; Sources.</p>

<h2>Installation</h2>

<p>The NuGet extensions addin is available from the Visual Studio for Mac extensions repository. To install the addin:</p>

<ul>
<li>From the main menu, open the Extensions Manager dialog.</li>
<li>Select the Gallery tab.</li>
<li>Expand IDE extensions.</li>
<li>Select NuGet Package Management Extensions 0.18 or later.</li>
<li>Click the Refresh button if the addin is not visible.</li>
<li>Click Installâ€¦ to install the addin.</li>
<li>Restart Visual Studio for Mac.</li>
</ul>

]]></content>
  </entry>
  
</feed>
